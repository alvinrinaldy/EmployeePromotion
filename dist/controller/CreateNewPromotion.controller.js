sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","./Dialog1","./utilities","sap/ui/core/routing/History","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,o,a,s,i,n,r){"use strict";return e.extend("ZAL.Promosi.controller.CreateNewPromotion",{handleRouteMatched:function(e){var t="App60336b1fade8e57e74bdb140";var o={};var a;if(this.sContext){a={path:"/"+this.sContext,parameters:o};this.getView().bindObject(a)}},_onInputValueHelpRequest:function(e){var t="Dialog1";this.mDialogs=this.mDialogs||{};var a=this.mDialogs[t];if(!a){a=new o(this.getView());this.mDialogs[t]=a;a.setRouter(this.oRouter)}var s=e.getSource().getBindingContext();a._oControl.setBindingContext(s);a.open()},_onButtonPress:function(e){var o=e.getSource().getBindingContext();return new Promise(function(e){this.doNavigate("ListDataPromotion",o,e,"")}.bind(this)).catch(function(e){if(e!==undefined){t.error(e.message)}})},doNavigate:function(e,t,o,a){var s=t?t.getPath():null;var i=t?t.getModel():null;var n;if(s!==null&&s!==""){if(s.substring(0,1)==="/"){s=s.substring(1)}n=s.split("(")[0]}var r;var l=this.sMasterContext?this.sMasterContext:s;if(n!==null){r=a||this.getOwnerComponent().getNavigationPropertyForNavigationWithContext(n,e)}if(r!==null&&r!==undefined){if(r===""){this.oRouter.navTo(e,{context:s,masterContext:l},false)}else{i.createBindingContext(r,t,null,function(t){if(t){s=t.getPath();if(s.substring(0,1)==="/"){s=s.substring(1)}}else{s="undefined"}if(s==="undefined"){this.oRouter.navTo(e)}else{this.oRouter.navTo(e,{context:s,masterContext:l},false)}}.bind(this))}}else{this.oRouter.navTo(e)}if(typeof o==="function"){o()}},_onButtonPress1:function(e){var o=e.getSource().getBindingContext();return new Promise(function(e){this.doNavigate("SelectEmployeePromotion",o,e,"")}.bind(this)).catch(function(e){if(e!==undefined){t.error(e.message)}})},_onObjectMatched:function(e){this.getView().bindElement({path:decodeURIComponent("/SelectEmployeeSet('"+e.getParameter("arguments").EmployeeId+"')"),model:"Employee"});var t=e.getParameter("arguments").EmployeeId;var o=decodeURIComponent(e.getParameter("arguments").EmployeeName);i.show(t+" - "+o);this.getView().byId("EmployeeId").setValue(t);this.getView().byId("EmployeeName").setValue(o);this.sUrl="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";this.oModelData=new sap.ui.model.odata.ODataModel(this.sUrl,true);var a=this.getOwnerComponent().getModel("CreateNewPromotion"),s=new sap.ui.model.json.JSONModel;this.getView().setModel(a);this.getView().setModel(s,"LastEducation");this.oModelData.read("/LastEducationSet('"+t+"')",{success:function(e,t){s.setData(e)},error:function(e){}});var n=this.getOwnerComponent().getModel("CreateNewPromotion"),r=new sap.ui.model.json.JSONModel;this.getView().setModel(n);this.getView().setModel(r,"CurrentOrganization");this.oModelData.read("/LISTREQUESTDATAPROMOTIONSet(Reqid='',Pernr='"+t+"')",{success:function(e,t){r.setData(e)},error:function(e){}});var l=this.getOwnerComponent().getModel("CreateNewPromotion"),g=new sap.ui.model.json.JSONModel;this.getView().setModel(l);this.getView().setModel(g,"ServiceLength");this.oModelData.read("/LengthOfServiceSet(Pernr='"+t+"')",{success:function(e,t){g.setData(e)},error:function(e){}});var u=this.getOwnerComponent().getModel("CreateNewPromotion"),d=new sap.ui.model.json.JSONModel;this.getView().setModel(u);this.getView().setModel(d,"PerformanceAppraisal");this.oModelData.read("/PerformanceAppraisalsSet('"+t+"')",{success:function(e,t){d.setData(e);console.log("success")},error:function(e){console.log("error")}});var h=this.getOwnerComponent().getModel("CreateNewPromotion"),p=new sap.ui.model.json.JSONModel;this.getView().setModel(h);this.getView().setModel(p,"WarningLetter");this.oModelData.read("/WarningLetterSet(Pernr='"+t+"')",{success:function(e,t){p.setData(e)},error:function(e){}})},onInit:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("CreateNewPromotion").attachPatternMatched(this._onObjectMatched,this);var t="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";var o=new sap.ui.model.odata.v2.ODataModel(t);this.getView().setModel(o,"odataPromosi")},handleValueHelpSelectGolongan:function(e){if(!this._valueHelpDialogGolongan){this._valueHelpDialogGolongan=sap.ui.xmlfragment("ZAL.Promosi.view.ValueHelpDialog.ValueHelpSelectGolongan",this);this.getView().addDependent(this._valueHelpDialogGolongan)}this._valueHelpDialogGolongan.open()},handleValueHelpGolonganClose:function(e){var t=e.getParameter("selectedContexts");var o=t[0].sPath;var a=this.getView().byId("idGolongan");a.setValue(this.getView().getModel("odataPromosi").getProperty(o).Persk+" - "+this.getView().getModel("odataPromosi").getProperty(o).Ptext)},handleValueHelpPositionSearch:function(e){var t=e.getParameter("selectedContexts");var o=this.getView().byId("idPosition");var a=e.getParameter("value").toUpperCase();var s=[];if(a!==""){var i=a.toLowerCase();var l=a.toUpperCase();var g=a[0].toUpperCase()+a.substr(1).toLowerCase();s.push(new n("PlansA",r.Contains,i));s.push(new n("PlansA",r.Contains,l));s.push(new n("PlansA",r.Contains,g));s.push(new n("PlansA",r.Contains,a))}else{s.push(new n("PlansA",r.Contains,a))}e.getSource().getBinding("items").filter(s)},handleValueHelpGolonganSearch:function(e){var t=e.getParameter("selectedContexts");var o=this.getView().byId("idGolongan");var a=e.getParameter("value").toUpperCase();var s=[];if(a!==""){var i=a.toLowerCase();var l=a.toUpperCase();var g=a[0].toUpperCase()+a.substr(1).toLowerCase();s.push(new n("Persk",r.Contains,i));s.push(new n("Persk",r.Contains,l));s.push(new n("Persk",r.Contains,g));s.push(new n("Persk",r.Contains,a))}else{s.push(new n("Persk",r.Contains,a))}e.getSource().getBinding("items").filter(s)},handleValueHelpOrgKeySearch:function(e){var t=e.getParameter("selectedContexts");var o=this.getView().byId("OrgKeyA");var a=e.getParameter("value").toUpperCase();var s=[];if(a!==""){var i=a.toLowerCase();var l=a.toUpperCase();var g=a[0].toUpperCase()+a.substr(1).toLowerCase();s.push(new n("Orgky",r.Contains,i));s.push(new n("Orgky",r.Contains,l));s.push(new n("Orgky",r.Contains,g));s.push(new n("Orgky",r.Contains,a))}else{s.push(new n("Orgky",r.Contains,a))}e.getSource().getBinding("items").filter(s)},handleValueHelpSelectPosition:function(e){if(!this._valueHelpDialogPosition){this._valueHelpDialogPosition=sap.ui.xmlfragment("ZAL.Promosi.view.ValueHelpDialog.ValueHelpSelectPosition",this);this.getView().addDependent(this._valueHelpDialogPosition)}this._valueHelpDialogPosition.open()},handleValueHelpPositionClose:function(e){var t=e.getParameter("selectedContexts");var o=t[0].sPath;var a=this.getView().byId("idPosition");var s=this.getView().byId("DivisionA");var i=this.getView().byId("DepartmentA");var n=this.getView().byId("SectionA");a.setValue(this.getView().getModel("odataPromosi").getProperty(o).PlansA+" - "+this.getView().getModel("odataPromosi").getProperty(o).PlansTxtA);s.setValue(this.getView().getModel("odataPromosi").getProperty(o).DiviA+" - "+this.getView().getModel("odataPromosi").getProperty(o).DiviTxtA);i.setValue(this.getView().getModel("odataPromosi").getProperty(o).DeptA+" - "+this.getView().getModel("odataPromosi").getProperty(o).DeptTxtA);n.setValue(this.getView().getModel("odataPromosi").getProperty(o).SectA+" - "+this.getView().getModel("odataPromosi").getProperty(o).SectTxtA)},handleValueHelpSelectOrgKey:function(e){if(!this._valueHelpDialogOrgKey){this._valueHelpDialogOrgKey=sap.ui.xmlfragment("ZAL.Promosi.view.ValueHelpDialog.ValueHelpSelectOrgKey",this);this.getView().addDependent(this._valueHelpDialogOrgKey)}this._valueHelpDialogOrgKey.open()},handleValueHelpOrgKeyClose:function(e){var t=e.getParameter("selectedContexts");var o=t[0].sPath;var a=this.getView().byId("OrgKeyA");a.setValue(this.getView().getModel("odataPromosi").getProperty(o).Orgky)},postRequestPromosi:function(){console.log("Post Request pressed..");var e=this.getView().byId("EmployeeId").getValue();var o=this.getView().byId("EmployeeName").getValue();var a=this.getView().byId("StartDateC").getValue();var s="31.12.9999";var i=moment(this.getView().byId("StartDateA").getValue()).format("L");var n=moment(this.getView().byId("StartDateA").getValue()).format("DD[.]MM[.]YYYY");var r=moment(i).subtract(1,"days").format("DD[.]MM[.]YYYY");console.log("Date List: ");console.log("BegdaC: "+a);console.log("EnddaA: "+s);console.log("BegdaA: "+n);console.log("EnddaC: "+r);var l=this.getView().byId("CompanyCodeC").getValue();var g=this.getView().byId("CompanyNameC").getValue();var u=this.getView().byId("UnitC").getValue();var d=this.getView().byId("DivisionC").getValue().substr(0,8);var h=this.getView().byId("DepartmentC").getValue().substr(0,8);var p=this.getView().byId("SectionC").getValue().substr(0,8);var c=this.getView().byId("PosisiC").getValue().substr(0,8);var v=this.getView().byId("JabatanC").getValue().substr(0,8);var m=this.getView().byId("GolonganC").getValue().substr(0,2);var V=this.getView().byId("OrgKeyC").getValue();var w=this.getView().byId("CompanyCode").getValue();var C=this.getView().byId("CompanyName").getValue();var P=this.getView().byId("UnitA").getValue();var y=this.getView().byId("DivisionA").getValue().substr(0,8);var f=this.getView().byId("DepartmentA").getValue().substr(0,8);var b=this.getView().byId("SectionA").getValue().substr(0,8);var D=this.getView().byId("idPosition").getValue().substr(0,8);var M=this.getView().byId("JabatanA").getValue().substr(0,8);var S=this.getView().byId("idGolongan").getValue().substr(0,2);var A=this.getView().byId("OrgKeyA").getValue();var I=this.getView().byId("ReasonPromotion").getValue().substr(0,2);var O=this.getView().byId("ReasonPromotion").getValue().substr(3,2);var x=this.getView().byId("CommentRequest").getValue();var R=this.getView().byId("Recommendation").getValue();var H={};H.Vdsk1C=V;H.Pernr=e;H.Vdsk1TxtC="";H.Status="";H.Vdsk1A=A;H.Massn=I;H.Vdsk1TxtA="";H.Chngby="";H.Massg=O;H.Cname=o;H.Appby="";H.BukrsC=l;H.UnitC=u;H.DiviC=d;H.DeptC=h;H.SectC=p;H.PlansC=c;H.StellC=v;H.PerskC=m;H.ButxtC=g;H.DiviTxtC="";H.DeptTxtC="";H.SectTxtC="";H.PlansTxtC="";H.StellTxtC="";H.BukrsA=w;H.UnitA=P;H.DiviA=y;H.DeptA=f;H.SectA=b;H.PlansA=D;H.StellA=M;H.PerskA=S;H.ButxtA=C;H.DiviTxtA="";H.DeptTxtA="";H.SectTxtA="";H.PlansTxtA="";H.StellTxtA="";H.Recc=R;H.Notif1=x;H.StatusTxt="";H.Rscode="";H.RequestBy="";H.Chngdt="";H.BegdaC=a;H.Appdt="";H.EnddaC=r;H.BegdaA=n;H.EnddaA=s;H.RequestDate="";H.EfektifDate="";console.log(H);var T=sap.ui.core.BusyIndicator;var N="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";var _=new sap.ui.model.odata.v2.ODataModel(N);_.attachRequestSent(function(){T.show(0)});_.attachRequestCompleted(function(){T.hide()});_.setHeaders({"X-Requested-With":"X","X-CSRF-Token":"Fetch"});var E=this;_.create("/LISTREQUESTDATAPROMOTIONSet",H,{method:"POST",success:function(e){t.success("Employee Promotion is Successfully Requested",{onClose:function(){}})},error:function(e){var o=JSON.parse(e.responseText);t.error(o.error.message.value)}})}})},true);