sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","./utilities","sap/ui/core/routing/History"],function(e,t,a,o){"use strict";return e.extend("ZAL.Promosi.controller.DetailRequestPromotion",{handleRouteMatched:function(e){var t=sap.ui.getCore().getModel("RequestDetail");console.log("Pass Selected Data:");console.log(t);this.getView().setModel(t,"SelectData");console.log("Pernr of SelectData : ");var a=this.getView().getModel("SelectData").oData.Pernr;console.log(a);this.sUrl="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";this.oModelData=new sap.ui.model.odata.ODataModel(this.sUrl,true);var o=this.getOwnerComponent().getModel("DetailRequestPromotion"),s=new sap.ui.model.json.JSONModel;this.getView().setModel(o);this.getView().setModel(s,"LastEducation");this.oModelData.read("/LastEducationSet(Pernr='"+a+"')",{success:function(e,t){s.setData(e)},error:function(e){console.log("errorrrrrr")}});var i=this.getOwnerComponent().getModel("DetailRequestPromotion"),r=new sap.ui.model.json.JSONModel;this.getView().setModel(i);this.getView().setModel(r,"ServiceLength");this.oModelData.read("/LengthOfServiceSet(Pernr='"+a+"')",{success:function(e,t){r.setData(e)},error:function(e){}});var l=this.getOwnerComponent().getModel("DetailRequestPromotion"),n=new sap.ui.model.json.JSONModel;this.getView().setModel(l);this.getView().setModel(n,"PerformanceAppraisal");this.sUrl="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";this.oModelTest=new sap.ui.model.odata.ODataModel(this.sUrl,true);this.oModelTest.read("/PerfromanceAppraisalsSet(Pernr='"+a+"')",{success:function(e,t){n.setData(e)},error:function(e){}});var g=this.getOwnerComponent().getModel("DetailRequestPromotion"),d=new sap.ui.model.json.JSONModel;this.getView().setModel(g);this.getView().setModel(d,"WarningLetter");this.oModelData.read("/WarningLetterSet(Pernr='"+a+"')",{success:function(e,t){d.setData(e)},error:function(e){}})},onInit:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("DetailRequestPromotion").attachPatternMatched(this.handleRouteMatched,this);var t="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";var a=new sap.ui.model.odata.v2.ODataModel(t);a.setDefaultCountMode(sap.ui.model.odata.CountMode.inline);this.getView().setModel(a,"odataPromosi")},handleValueHelpSelectGolongan:function(e){if(!this._valueHelpDialogGolongan){this._valueHelpDialogGolongan=sap.ui.xmlfragment("ZAL.Promosi.view.ValueHelpDialog.ValueHelpSelectGolongan",this);this.getView().addDependent(this._valueHelpDialogGolongan)}this._valueHelpDialogGolongan.open()},handleValueHelpGolonganClose:function(e){var t=e.getParameter("selectedContexts");var a=t[0].sPath;var o=this.getView().byId("idGolongan");o.setValue(this.getView().getModel("odataPromosi").getProperty(a).Persk+" - "+this.getView().getModel("odataPromosi").getProperty(a).Ptext)},handleValueHelpSelectPosition:function(e){if(!this._valueHelpDialogPosition){this._valueHelpDialogPosition=sap.ui.xmlfragment("ZAL.Promosi.view.ValueHelpDialog.ValueHelpSelectPosition",this);this.getView().addDependent(this._valueHelpDialogPosition)}this._valueHelpDialogPosition.open()},handleValueHelpPositionClose:function(e){var t=e.getParameter("selectedContexts");var a=t[0].sPath;var o=this.getView().byId("idPosition");var s=this.getView().byId("DivisionA");var i=this.getView().byId("DepartmentA");var r=this.getView().byId("SectionA");o.setValue(this.getView().getModel("odataPromosi").getProperty(a).PlansA+" - "+this.getView().getModel("odataPromosi").getProperty(a).PlansTxtA);s.setValue(this.getView().getModel("odataPromosi").getProperty(a).DiviA+" - "+this.getView().getModel("odataPromosi").getProperty(a).DiviTxtA);i.setValue(this.getView().getModel("odataPromosi").getProperty(a).DeptA+" - "+this.getView().getModel("odataPromosi").getProperty(a).DeptTxtA);r.setValue(this.getView().getModel("odataPromosi").getProperty(a).SectA+" - "+this.getView().getModel("odataPromosi").getProperty(a).SectTxtA)},updateRequestPromosi:function(){console.log("Update Request pressed..");var e=this.getView().byId("RequestId").getValue();var a=this.getView().byId("EmployeeId").getValue();var o=this.getView().byId("EmployeeName").getValue();var s=new Date(this.getView().byId("StartDateA").getValue());var i=new Date;i.setDate(s.getDate()-1);var r=toString(i).substr(8,2);var l=String(i).substr(5,2);var n=i.toString().substr(0,4);var g=r+"-"+l+"-"+n;var d=this.getView().byId("EndDateA").getValue();console.log("BegdaA:");console.log(g);console.log("Yesterday of Selected Date is:");console.log(i);var u=this.getView().byId("CompanyCodeC").getValue();var V=this.getView().byId("CompanyNameC").getValue();var h=this.getView().byId("UnitC").getValue();var p=this.getView().byId("DivisionC").getValue().substr(0,8);var c=this.getView().byId("DepartmentC").getValue().substr(0,8);var v=this.getView().byId("SectionC").getValue().substr(0,8);var w=this.getView().byId("PosisiC").getValue().substr(0,8);var P=this.getView().byId("JabatanC").getValue().substr(0,8);var m=this.getView().byId("GolonganC").getValue().substr(0,2);var D=this.getView().byId("OrgKeyC").getValue();var y=this.getView().byId("CompanyCode").getValue();var b=this.getView().byId("CompanyName").getValue();var C=this.getView().byId("UnitA").getValue();var M=this.getView().byId("DivisionA").getValue().substr(0,8);var S=this.getView().byId("DepartmentA").getValue().substr(0,8);var I=this.getView().byId("SectionA").getValue().substr(0,8);var A=this.getView().byId("idPosition").getValue().substr(0,8);var R=this.getView().byId("JabatanA").getValue().substr(0,8);var f=this.getView().byId("idGolongan").getValue().substr(0,2);var x=this.getView().byId("OrgKeyA").getValue();var O=this.getView().byId("HiringDate").getValue();var T=parseInt(this.getView().byId("LosYear").getValue(),10);var H=this.getView().byId("LosMonth").getValue();var q=this.getView().byId("LastPromotionDate").getValue();var _=this.getView().byId("ReasonPromotion").getValue().substr(0,2);var L=this.getView().byId("ReasonPromotion").getValue().substr(3,2);var U=this.getView().byId("CommentRequest").getValue();var k=this.getView().byId("Recommendation").getValue();var N={};N.Reqid=e;N.Vdsk1C=D;N.Pernr=a;N.Vdsk1TxtC="";N.Status="";N.Vdsk1A=x;N.Massn=_;N.Vdsk1TxtA="";N.Chngby="";N.Massg=L;N.Cname=o;N.Appby="";N.BukrsC=u;N.UnitC=h;N.DiviC=p;N.DeptC=c;N.SectC=v;N.PlansC=w;N.StellC=P;N.PerskC=m;N.ButxtC=V;N.DiviTxtC="";N.DeptTxtC="";N.SectTxtC="";N.PlansTxtC="";N.StellTxtC="";N.BukrsA=y;N.UnitA=C;N.DiviA=M;N.DeptA=S;N.SectA=I;N.PlansA=A;N.StellA=R;N.PerskA=f;N.ButxtA=b;N.DiviTxtA="";N.DeptTxtA="";N.SectTxtA="";N.PlansTxtA="";N.StellTxtA="";N.Recc=k;N.Notif1=U;N.StatusTxt="";N.Rscode="";N.RequestBy="";N.Chngdt="";N.BegdaC="";N.Appdt="";N.EnddaC="";N.BegdaA=g;N.EnddaA=d;N.RequestDate="";N.EfektifDate="";console.log(N);var B=sap.ui.core.BusyIndicator;var E="/sap/opu/odata/sap/ZHCM_PROMOSI_SRV/";var G=new sap.ui.model.odata.v2.ODataModel(E);G.attachRequestSent(function(){B.show(0)});G.attachRequestCompleted(function(){B.hide()});G.setHeaders({"X-Requested-With":"X","X-CSRF-Token":"Fetch"});var J=this;G.update("/LISTREQUESTDATAPROMOTIONSet(Reqid='"+N.Reqid+"',Pernr='"+N.Pernr+"')",N,{method:"PUT",success:function(e){t.success("Request Number"+N.Reqid+" is Successfully Updated",{onClose:function(){}})},error:function(e){var a=JSON.parse(e.responseText);t.error(a.error.message.value)}})}})},true);